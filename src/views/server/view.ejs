<%- include('../static/navbar.ejs', { user }) %>
<% if(db) { %>
  <% if(db.gizli) { %>
  <% if(user) { %>
  <% if(!guild.members.cache.get(user.id) && !guild.members.cache.get(user.id).permissions.has('MANAGE_GUILD')) { %>
  <%= res.redirect('/') %>
  <% } %>
  <% } else { %>
  <%= res.redirect('/') %>
  <% } %>

  <% } else { %>
  <head>
      <title>Desion | <%=guild.name%></title>
      <meta property="og:site_name" content="Powered by Desion.me">
      <meta property="og:title" content="<%= guild.name %>">
      <meta property="og:description" content="<%= guild.description ? guild.description : 'Add your server, join the competition and grow your server!' %>">
      <meta property="og:image" content="Desion Image Area">
      <meta name="twitter:card" content="summary">
      <meta property="og:image:width" content="600"/>
      <meta property="og:image:height" content="600"/>
  </head>
  <% } %>
  <% } %>

<div id="serverInfo" class="flex flex-wrap bg-d">
	<div class="container">
		<div id="serverStats" class="flex flex-wrap">
			<div class="w-full sm:w-1/2 md:w-1/4 flex flex-col p-2">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">
						<img onError="imgError(this)" class="rounded-lg" src="https://cdn.discordapp.com/icons/<%=guild.id%>/<%=guild.icon%>?size=2048" width="2048">
					</div>
				</div>
			</div>
			<div class="w-full sm:w-1/2 md:w-1/2 flex flex-col p-2">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-2xl h1 text-left">
						<div class="flex items-center">
							<span translate="no" class="h1"><%= guild.name %></span>

							<% if(guild.id === "849011617962393638" || guild.id === "701153938870894673") { %>
							&nbsp;<!-- Resmi Sunucu --> 
							<svg class="tippy" width="25px" style="margin:5px" data-tippy-content="Resmi Sunucu" viewBox="0 0 210.35 232.99" xmlns="http://www.w3.org/2000/svg">
								<defs>
									<style>.cls-1 {fill: #6ca2fc;}</style>
								</defs>
								<g data-name="katman 2">
									<g data-name="katman 1">
										<path class="cls-1" d="M208.3,62.49c1.31,4.07,1.28,8.26,1.34,12.48.28,18.06-.07,36.12.64,54.2.89,22.73-7.14,43-20.35,61.15-14,19.18-31.9,33.19-55,39.87A88.82,88.82,0,0,1,116.83,233c-2.77.21-3.53-.85-4.08-3.3-3.84-17.15-2-33.88,4.28-50.05,10-25.92,27-46,51.68-59.29,3.86-2.08,7.77-4.17,12-5.17,4-1,4.92-3,4.81-6.92-.33-12.22-.17-24.45-.18-36.68s7.7-17.61,19-13Z"/>
										<path class="cls-1" d="M31.37,203.44C10.49,180.63-1.84,154.74.22,122.78c1.12-17.22.27-34.57.24-51.85,0-5,1.28-9.25,5.71-12,8.23-5,18.27.46,18.51,10.32.26,10.63.09,21.28.12,31.92,0,4-1.09,8.51.45,11.79s6.67,3,10.09,4.59c35.28,16.78,56.37,44.47,63.58,82.72,1.88,10,1.1,20.1-1.11,30.09-.49,2.19-1.4,2.66-3.42,2.6-18.58-.52-34.86-7.28-49.7-18.07A134,134,0,0,1,31.37,203.44Z"/>
										<path class="cls-1" d="m98.67 147.59c-11.67-10.88-19.15-24.3-23.56-39.45-7.19-24.63-6.33-49.06 3-73a84.27 84.27 0 0 1 22.89-33.14c3-2.62 4.78-2.7 7.79-0.1 13 11.24 21.31 25.37 26.1 41.57 7.8 26.42 6.53 52.48-4.62 77.81a80 80 0 0 1-23.11 30.5c-1.67 1.34-2.65 1.13-4-0.2s-3-2.66-4.49-3.99z"/>
									</g>
								</g>
							</svg>
							<% } %>
							<% if(db) { %>
              <% if(db.partner === "Partnered") { %>
							&nbsp;<!-- Ortak --> 
							<svg class="tippy" width="25px" style="margin:5px" data-tippy-content="Ortak" viewBox="0 0 403.82 402.79" xmlns="http://www.w3.org/2000/svg">
								<defs>
									<style>.cls-2 {fill: #f2f2f2 !important}.cls-3 {fill: #958ced !important}</style>
								</defs>
								<g data-name="katman 2">
									<g data-name="katman 1">
										<path class="cls-2" d="M353.1,200.53c1.58,0,2.12-1.38,3-2.25,9.64-9.54,19.31-19.05,28.76-28.78,2.19-2.25,3.28-2,5.24.12,4.07,4.37,8.37,8.54,12.68,12.69,1.37,1.31,1.43,2.05,0,3.41-4.71,4.5-9.2,9.23-13.91,13.73-1.52,1.46-1.52,2.3,0,3.76,4.71,4.5,9.2,9.23,13.91,13.73,1.42,1.36,1.36,2.1,0,3.41-4.5,4.34-9,8.69-13.25,13.26-1.84,2-2.77,1.41-4.36-.2q-14.43-14.61-29.07-29c-.87-.86-1.41-2.29-3-2.25Z"/>
										<path class="cls-2" d="M201.35,50.62c0-1.58-1.39-2.11-2.26-3C189.53,38,180,28.37,170.26,18.93c-2.26-2.18-2-3.27.11-5.22,4.39-4.07,8.57-8.36,12.72-12.67,1.31-1.36,2-1.42,3.41,0,4.51,4.7,9.25,9.18,13.76,13.88,1.46,1.52,2.31,1.52,3.77,0,4.51-4.7,9.25-9.18,13.76-13.88,1.36-1.42,2.1-1.36,3.42,0,4.34,4.5,8.7,9,13.28,13.23,2,1.83,1.41,2.77-.2,4.35Q219.65,33,205.2,47.64c-.86.87-2.29,1.4-2.25,3Z"/>
										<path class="cls-3" d="M81.07,133.71a56.77,56.77,0,0,1-24.29-5c-22.3-10.28-34.54-33.52-30.73-58.37C29.51,47.73,48.92,29.12,72.31,26c30.61-4.11,58.66,18.51,61,49.22.48,6.19.47,6.16,6.58,5,21.44-4.26,41.25-.35,59.28,12,2,1.38,3.31,1.2,5.16-.07,19.09-13,39.94-16.65,62.37-11.4,2.64.62,3.31.13,3.4-2.66.95-28.78,22.34-50.42,51.79-52.58C348,23.52,372.39,43,377.52,69.92c6.05,31.73-17.86,61.63-50.9,63.41-3.56.19-4.31.74-3.47,4.41,5.13,22.13,1.22,42.69-11.66,61.44-1.37,2-1.21,3.24.06,5.12C324.11,222.88,328.09,243.15,323,265c-.79,3.43-.73,4.68,3.47,4.86,27.14,1.13,49.69,22.65,51.39,48.67,1.88,28.85-16.43,53.18-43.91,58.33-32.51,6.09-63.24-18.55-64-51.46-.07-3.12-.58-3.63-3.72-2.9C243.83,327.71,223,324.1,203.92,311c-1.7-1.17-2.86-1.1-4.54,0q-28.49,19.27-62,11.31c-2.75-.66-3.57-.33-3.67,2.73-.85,28.57-22.56,50.42-51.93,52.47-26.23,1.82-51-18.25-55.57-45-5.45-31.93,18.37-61.38,51.13-62.89,3.92-.18,4-1.19,3.3-4.53-4.88-21.83-1.27-42.19,11.32-60.8,1.18-1.74,1.58-3,.27-4.89-13.46-19.69-17-41.14-11.16-64.18A6.82,6.82,0,0,0,81.07,133.71Zm196.32,67.72c-.8-.84-1.42-1.51-2.07-2.16q-35.59-35.53-71.17-71.1c-1.61-1.62-2.46-2.06-4.35-.17q-35.62,35.79-71.46,71.37c-1.5,1.49-1.91,2.32-.17,4q36,35.73,71.79,71.62c1.37,1.37,2.15,1.79,3.76.17q35.94-36,72-72C276.27,202.7,276.76,202.12,277.39,201.43Z"/>
										<path class="cls-2" d="M236,386.8c-.34.37-.77.87-1.23,1.33-4.51,4.51-9.11,8.95-13.51,13.58-1.58,1.66-2.4,1.13-3.7-.21-4.36-4.48-8.91-8.78-13.21-13.32-1.65-1.74-2.59-2-4.35-.08-4.37,4.66-9.05,9-13.48,13.62-1.32,1.37-2.06,1.46-3.42,0-4.43-4.6-8.93-9.13-13.56-13.53-1.67-1.58-1.2-2.41.17-3.77Q185,369.32,200.19,354c1.42-1.44,2.24-1.63,3.78-.08,10.19,10.32,20.49,20.53,30.74,30.79C235.24,385.24,236.1,385.61,236,386.8Z"/>
										<path class="cls-2" d="M50.72,202.26c-1.58,0-2.12,1.39-3,2.25-9.64,9.54-19.31,19.06-28.76,28.78-2.19,2.25-3.28,2-5.24-.11-4.07-4.38-8.37-8.55-12.68-12.7-1.37-1.31-1.43-2,0-3.4,4.71-4.5,9.2-9.23,13.91-13.74,1.52-1.46,1.52-2.3,0-3.76-4.71-4.5-9.2-9.23-13.91-13.73-1.42-1.36-1.36-2.1,0-3.41,4.5-4.33,9-8.69,13.25-13.26,1.84-2,2.77-1.41,4.36.2q14.43,14.61,29.07,29c.87.87,1.41,2.29,3,2.25Z"/>
									</g>
								</g>
							</svg>
              <% } %>
							<% if(db.verified === "Verified") { %>                
							&nbsp;<!-- Onaylı Sunucuu --> 
							<svg class="tippy" width="25px" style="margin:5px" data-tippy-content="Doğrulandı" viewBox="0 0 319.75 319.1" xmlns="http://www.w3.org/2000/svg">
								<defs>
									<style>.cls-31 {fill: #1bfa8b}</style>
								</defs>
								<g data-name="katman 2">
									<g data-name="katman 1">
										<path class="cls-31" d="M142.64,318.36l-12.71-1.77a201.52,201.52,0,0,1-38.82-12.71l-10-5.14A210.33,210.33,0,0,1,51.28,277L43,268.73a206,206,0,0,1-22.35-30.27q-2.3-4.29-4.57-8.59A189.12,189.12,0,0,1,3,190.78L.85,178.26C.37,171-.06,163.67,0,156.35c.1-11.58,1.9-22.94,4.25-34.24q3.24-10.45,6.49-20.9c5.58-12.62,11.83-24.86,20.1-36A160,160,0,0,1,98.81,12c.9-.37,1.74-.89,2.61-1.35l20.87-6.34C140.86-.15,159.66-.83,178.61.82L191.15,2.9c13.61,2.7,26.53,7.46,39.18,13l8.59,4.62a201.82,201.82,0,0,1,30.34,22.29l8.27,8.32A207.71,207.71,0,0,1,299.32,81l5.19,9.87c4.79,11.33,9.21,22.78,11.68,34.88.27,1.33.67,2.62,1,3.93L319,142.35a176.29,176.29,0,0,1-4,56.87q-3.66,10.86-7.33,21.71c-6.73,15-15,29.13-25.7,41.71a160,160,0,0,1-58.17,43.23c-1.12.49-2.21,1.08-3.31,1.62l-20.9,7c-7.33,1.22-14.57,3-22,3.77A189.23,189.23,0,0,1,142.64,318.36ZM99.23,160.06c-11.25-2.53-21.56,7.43-18.86,18.22a10.6,10.6,0,0,0,3.41,7.63c7.26,7.36,14.66,14.58,22,21.85a43.48,43.48,0,0,0,6.55,6.53c8.88,11.77,20.21,11.68,30.22,1.44,29.9-30.56,60.4-60.54,90.66-90.75a42.9,42.9,0,0,0,3.08-3.25,15.64,15.64,0,0,0-5.75-24.38c-6.64-3.2-13.12-1.93-18.93,3.88Q177.77,135,144,168.87c-5.37,5.36-10.83,10.64-16.24,15.95q-10.08-10.15-20.16-20.3C105.24,162.2,102.63,160.37,99.23,160.06Z"/>
									</g>
								</g>
							</svg>
							<% } %>
							<% } %>  
						</div>
					</div>
					<div class="text-xl text-left mt-3">
						<div class="items-center">
							<div style="float: left;">
								<div class="flex">
									<p class="text-muted">
              <% if(db) { %>
              <% if(db.gizli) { %>
              <span class="badge bg-red-500 h6 text-white p-1">Bu sunucu gizlenmiş.</span><br />
              <% } %>
              <% } %>
										<% if(guild.description) { %>
										<%= guild.description %>
										<% } else { %>
										Bir açıklama bulunamadı.&nbsp;<span class="tippy" data-tippy-content="Eğer bu sunucu sana aitse ve bir açıklama girmek istiyorsan, Topluluk kısmından Genel Görünüm'e tıklayıp bir açıklama girebilirsin.">
										<i class="fas fa-question-circle"></i>
										</span>
										<% } %>
										<br /><br /><br />
										<i class="fas fa-arrow-right"></i>&nbsp;<%= guild.memberCount.toLocaleString().replace(',', '.') %> üyeden <%= guild.channels.cache.filter(a => a.type === 'voice').reduce((a,b) => a + b.members.size, 0) %> tanesi sesli kanalda.
									</p>
								</div>
								<div class="flex">
                    <% 
                    if(user) {
                      let getSupport = client.guilds.cache.get('849011617962393638');
                      let getUserFromSupport = getSupport.members.cache.get(user.id);
                    %>
                  
                  <% 
                  if(getUserFromSupport) {
                  if(getUserFromSupport.roles.cache.get('867530131240779786')) { 
                  %>
                  
                  <!-- PARTNER ALMA FORMU -->
                 <div class="modal fade" id="unPartner" tabindex="-1" aria-labelledby="unPartner" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered">
											<div class="modal-content bg-d">
												<div class="modal-header" style="border: none;">
													<h5 class="modal-title" id="exampleModalLabel">
                            Partner İptal Formu
                          </h5>
													<button type="button" class="btn btn-primary" data-bs-dismiss="modal">
													<i class="fas fa-times text-white hover:text-indigo-500 transition-all duration-100"></i>
													</button>
												</div>
												<div class="modal-body">
                          <form id="myUnVerifyForm" method="POST" class="form-discorddark">
														<div class="form-group">
															<textarea type="text" class="form-control bg-gray-700 text-white border-none" placeholder="Bir sebep giriniz." id="getPartnerReason" name="getPartnerReason"></textarea>
														</div>
                            <div class="modal-footer" style="border: none;">
                            <button type="button" onclick="clickTakePartner()" id="myUnPartnerButton" class="btn btn-primary"><i class="fad fa-paper-plane"></i>&nbsp;Gönder</button>
                          </div>
                          </form>
                        </div>
                      </div>
										</div>
									</div>
                  <!-- ONAY RED FORMU -->
                 <div class="modal fade" id="getVerify" tabindex="-1" aria-labelledby="getVerify" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered">
											<div class="modal-content bg-d">
												<div class="modal-header" style="border: none;">
													<h5 class="modal-title" id="exampleModalLabel">
                            Onay başvurusu red formu
                          </h5>
													<button type="button" class="btn btn-primary" data-bs-dismiss="modal">
													<i class="fas fa-times text-white hover:text-indigo-500 transition-all duration-100"></i>
													</button>
												</div>
												<div class="modal-body">
                          <form id="myUnVerifyForm" method="POST" class="form-discorddark">
														<div class="form-group">
															<textarea type="text" class="form-control bg-gray-700 text-white border-none" placeholder="Bir sebep giriniz." id="getVerifyReason" name="getVerifyReason"></textarea>
														</div>
                            <div class="modal-footer" style="border: none;">
                            <button type="button" onclick="clickTakeMyVerifyAdmin()" id="myUnVerifyButton" class="btn btn-primary"><i class="fad fa-paper-plane"></i>&nbsp;Gönder</button>
                          </div>
                          </form>
                        </div>
                      </div>
										</div>
									</div>
                  
                  
                  <div class="dropdown">
                    <button class="btn btn-success dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Admin
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <% if(db) { %>
                      <a class="dropdown-item" href="javascript:clickGiveVerifyWithAdmin()" id="myVerifyAdmin"><i class="fas fa-check-circle"></i>&nbsp;Onay Ver</a>
                       <script>
                        function clickGiveVerifyWithAdmin() {
                            $("#myVerifyAdmin").attr("disabled", true);
                            $("#myVerifyAdmin").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
                            setTimeout(() => {
                                $.post("/admin/verify/<%= guild.id %>", {})
                                    .done(function(data) {
                                        if (data.error) {
                                            Swal.fire({
                                                icon: 'error',
                                                title: 'Olamaaz...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myVerifyAdmin").html('<i class="fas fa-check-circle"></i>&nbsp;Onay Ver');
                                            $("#myVerifyAdmin").attr("disabled", false);
                                            return;
                                        } else {
                                            Swal.fire({
                                                icon: 'success',
                                                title: 'Başarılı...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myVerifyAdmin").html('<i class="fas fa-check-circle"></i>&nbsp;Onay Ver');
                                            $("#myVerifyAdmin").attr("disabled", false);
                                            return;
                                        }
                                    });
                            }, 2000)
                        }
                      </script>
                      <a class="dropdown-item" href="javascript:" data-bs-toggle="modal" data-bs-target="#getVerify"><i class="fas fa-times-circle"></i>&nbsp;Onay Al</a>
                       <script>
                        function clickTakeMyVerifyAdmin() {
                            $("#myUnVerifyButton").attr("disabled", true);
                            $("#myUnVerifyButton").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
                            setTimeout(() => {
                                $.post("/admin/unverify/<%= guild.id %>", {
                                       reason: $('#getVerifyReason').val()
                                       })
                                    .done(function(data) {
                                        if (data.error) {
                                            Swal.fire({
                                                icon: 'error',
                                                title: 'Olamaaz...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myUnVerifyButton").html('<i class="fas fa-check-circle"></i>&nbsp;Gönder');
                                            $("#myUnVerifyButton").attr("disabled", false);
                                            return;
                                        } else {
                                            Swal.fire({
                                                icon: 'success',
                                                title: 'Başarılı...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myUnVerifyButton").html('<i class="fas fa-check-circle"></i>&nbsp;Gönder');
                                            $("#myUnVerifyButton").attr("disabled", false);
                                            return;
                                        }
                                    });
                            }, 2000)
                        }
                      </script>
                      
                      <% } %>
                      <% if(db) { %>
                      <% if(db.partner != "Partnered") { %>
                      <a class="dropdown-item" id="myMakePartnerButton" href="javascript:clickMakePartner()"><i class="fas fa-handshake"></i>&nbsp;Partner Ol</a>
                    <script>
                        function clickMakePartner() {
                            $("#myMakePartnerButton").attr("disabled", true);
                            $("#myMakePartnerButton").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
                            setTimeout(() => {
                                $.post("/admin/partner/make/<%= guild.id %>", {})
                                    .done(function(data) {
                                        if (data.error) {
                                            Swal.fire({
                                                icon: 'error',
                                                title: 'Olamaaz...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myMakePartnerButton").html('<i class="fas fa-handshake"></i>&nbsp;Partner Ol');
                                            $("#myMakePartnerButton").attr("disabled", false);
                                            return;
                                        } else {
                                            Swal.fire({
                                                icon: 'success',
                                                title: 'Başarılı...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myMakePartnerButton").html('<i class="fas fa-handshake"></i>&nbsp;Partner Ol');
                                            $("#myMakePartnerButton").attr("disabled", false);
                                            return;
                                        }
                                    });
                            }, 2000)
                        }
                      </script>
                      <% } else { %>
                      <a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#unPartner" id="myUnMakePartnerButton"><i class="fas fa-handshake"></i>&nbsp;Partneri İptal Et</a>
                    <script>
                        function clickTakePartner() {
                            $("#myUnPartnerButton").attr("disabled", true);
                            $("#myUnPartnerButton").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
                            setTimeout(() => {
                                $.post("/admin/partner/unmake/<%= guild.id %>", {
                                       reason: $('#getPartnerReason').val()
                                       })
                                    .done(function(data) {
                                        if (data.error) {
                                            Swal.fire({
                                                icon: 'error',
                                                title: 'Olamaaz...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myUnPartnerButton").html('<i class="fas fa-paper-plane"></i>&nbsp;Gönder');
                                            $("#myUnPartnerButton").attr("disabled", false);
                                            return;
                                        } else {
                                            Swal.fire({
                                                icon: 'success',
                                                title: 'Başarılı...',
                                                closeOnConfirm: false,
                                                text: data.message
                                            })
                                            $("#myUnPartnerButton").html('<i class="fas fa-paper-plane"></i>&nbsp;Gönder');
                                            $("#myUnPartnerButton").attr("disabled", false);
                                            return;
                                        }
                                    });
                            }, 2000)
                        }
                      </script>
                      <% } %>
                      <% } %>
                    </div>
                  </div>&nbsp;
                  <% } %>
                  <% } %>
                  <% } %>
									<% if(user && guild.members.cache.get(user.id) && guild.members.cache.get(user.id).permissions.has('MANAGE_GUILD')) { %>

                  <div id="snackbar">Sunucunuz onay başvurusu için yetersiz.</div>
                  <div class="dropdown">
                    <button class="btn btn-success dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      İşlemler
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <% if(guild.memberCount >= 1000) { %>
                      <a class="dropdown-item" href="javascript:" data-bs-toggle="modal" data-bs-target="#verifyModal"><i class="fas fa-check-circle"></i>&nbsp;Onay İste</a>
                      <% } else { %>
                      <a class="dropdown-item" href="javascript:" onClick="snackBar()"><i class="fas fa-check-circle"></i>&nbsp;Onay İste</a>
                      <% } %>
                      <a class="dropdown-item" href="javascript:" data-bs-toggle="modal" data-bs-target="#webhookModal"><i class="fas fa-megaphone"></i>&nbsp;Webhook'u Düzenle</a>
                      <a class="dropdown-item" href="javascript:" data-bs-toggle="modal" data-bs-target="#exampleModal"><i class="fas fa-pencil"></i>&nbsp;Sunucuyu Düzenle</a>
                    </div>
                  </div>&nbsp;
                 <div class="modal fade" id="verifyModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered">
											<div class="modal-content bg-d">
												<div class="modal-header" style="border: none;">
													<h5 class="modal-title" id="exampleModalLabel">
                            Onay Başvuru Formu
                          </h5>
													<button type="button" class="btn btn-primary" data-bs-dismiss="modal">
													<i class="fas fa-times text-white hover:text-indigo-500 transition-all duration-100"></i>
													</button>
												</div>
												<div class="modal-body">
                          <% if(guild.memberCount >= 1000) { %>
                          <% if(guild.memberCount >= 1000) { %>
                            <h6 class="modal-title">Değerlendirmemiz için altdaki boşlukları eksiksiz doldurun.</h6><br />
                          <% } %>
                          
                          <form id="myVerifyForm" method="POST" class="form-discorddark">
														<div class="form-group">
															<textarea type="text" class="form-control bg-gray-700 text-white border-none" placeholder="Sunucunuzu açıklayın, neden size onay vermeliyiz?" id="verifyDesc" name="verifyDesc"></textarea>
														</div>
														<div class="form-group mt-4">
															<input type="text" class="form-control bg-gray-700 text-white border-none" placeholder="Sunucunuzun sınırsız davet bağlantısını girin." id="serverInvite" name="serverInvite" />
														</div>
                            <div class="mt-4"></div>
                            <select data-placeholder="Sunucunuz için kalıcı bir etiket seçin." class="form-select p-2 rounded-sm" id="serverT" name="serverT" style="background-color: #1E2023;">
																<% global.config.website.tags.map(tag => { %>
																  <option value="<%=tag.value%>" selected><%= tag.name %></option>
																<% }) %>
															</select>
                              <p class="text-muted h6">
                               Unutma! Eğer sunucun onay alırsa seçmiş olduğun kategori kalıcı olacaktır. Sadece Team Desion ile iletişime geçerek değiştirebileceksin.
                              </p>
															<script>
																$(document).ready(function(){ 
																     $('#serverT').awselect() 
																});
															</script>
                            <div class="modal-footer" style="border: none;">
                            <button type="button" onclick="clickOnRequest()" id="myVerifyButton" class="btn btn-primary"><i class="fad fa-paper-plane"></i>&nbsp;Başvur</button>
                          </div>
                          </form>
                        <% } %>
                        </div>
                      </div>
										</div>
									</div>
                  
									<script>
										function clickOnRequest() {
										    $("#myVerifyButton").attr("disabled", true);
										    $("#myVerifyButton").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
										    setTimeout(() => {
										        $.post("/server/<%= guild.id %>/verify", {
										                invite: $('#serverInvite').val(),
                                    desc: $('#verifyDesc').val(),
										                tag: $('#serverT').val()
										            })
										            .done(function(data) {
										                if (data.error) {
										                    Swal.fire({
										                        icon: 'error',
										                        title: 'Olamaaz...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myVerifyButton").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myVerifyButton").attr("disabled", false);
										                    return;
										                } else {
										                    Swal.fire({
										                        icon: 'success',
										                        title: 'Başarılı...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myVerifyButton").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myVerifyButton").attr("disabled", false);
										                    return;
										                }
										            });
										    }, 2000)
										}
										          
									</script>
                  
                  <!-- Sunucu Düzenle -->
									<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered">
											<div class="modal-content bg-d">
												<div class="modal-header" style="border: none;">
													<h5 class="modal-title" id="exampleModalLabel">Sunucu Ayarları</h5>
													<button type="button" class="btn btn-primary" data-bs-dismiss="modal">
													<i class="fas fa-times text-white hover:text-indigo-500 transition-all duration-100"></i>
													</button>
												</div>
												<div class="modal-body">
													<form id="myEditForm" method="POST" class="form-discorddark">
														<div class="form-group">
															<label style="color: var(--body-text)!important;">
																<h6>Davet Bağlantısı;</h6>
															</label>
															<input type="text" class="form-control bg-gray-700 text-white border-none" value="<%= db ? db.invite : '' %>" placeholder="https://discord.gg/mghHcd58Th" id="invite" name="invite" />
														</div>
                            <% if(db) { %>
                              <% if(db.verified === "Verified") { %>
                                <div class="form-group">
                                  <label style="color: var(--body-text)!important;">
                                    <h6>Özel Sayfa Bağlantısı;</h6>
                                  </label>
                                  <input type="text" class="form-control bg-gray-700 text-white border-none" value="<%= db ? db.customURL : '' %>" placeholder="desion" id="desionEditCustomURL" name="desionEditCustomURL" />
                                </div>
                              <% } %>
                            <% } %>
                     					<div style="padding: 1px !important;" class="form-group">
															<label style="color: var(--body-text)!important;">
																<h6>Sunucu Etiketi;</h6>
															</label>
															<select data-placeholder="Bir sunucu etiketi seçin." class="form-select p-2 rounded-sm" id="tag" name="tag" style="background-color: #1E2023;">
																<% global.config.website.tags.map(tag => { %>
																<% if (db) { %>
																<% 
																	if(tag.value.includes(db.tag)) { 
																	%>
																<option value="<%=tag.value%>" selected><%= tag.name %></option>
																<% } else { %>
																<option value="<%=tag.value%>"><%= tag.name %></option>
																<% } %>
																<% } else { %>
																<option value="<%=tag.value%>" selected><%= tag.name %></option>
																<% } %>
																<% }) %>
															</select>
															<script>
																$(document).ready(function(){ 
																     $('#tag').awselect() 
																});
															</script>
														</div>
												</div>
                        <div class="mt-2 form-group">
                                &nbsp;&nbsp;&nbsp;&nbsp;Sunucuyu Gizle: <label class="switch">
                                  <input id="checkbox1" type="checkbox">
                                  <span class="slider round"></span>
                                </label>
                        </div>
												<div class="modal-footer" style="border: none;">
												<button type="button" onclick="clickOnAdd()" id="myButton" class="btn btn-primary"><i class="fad fa-save"></i>&nbsp;Kaydet</button>
												</form>
												</div>
											</div>
										</div>
									</div>
									<script>
                    <% if(db) { %>
                    <% if(db.gizli) { %>
                    $(function() {
                      $('#checkbox1').prop('checked', true);
                    })
                    <% } %>
                    <% } %>
										function clickOnAdd() {
										    $("#myButton").attr("disabled", true);
										    $("#myButton").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
										    setTimeout(() => {
										        $.post("/server/<%= guild.id %>", {
										                invite: $('#invite').val(),
										                webhook: $('#webhookEdit').val(),
										                tag: $('#tag').val(),
                                    gizli: $('#checkbox1').prop("checked"),
                                    customURL: $('#desionEditCustomURL').val()
										            })
										            .done(function(data) {
										                if (data.error) {
										                    Swal.fire({
										                        icon: 'error',
										                        title: 'Olamaaz...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myButton").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myButton").attr("disabled", false);
										                    return;
										                } else {
										                    Swal.fire({
										                        icon: 'success',
										                        title: 'Başarılı...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myButton").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myButton").attr("disabled", false);
										                     return;
										                }
										            });
										    }, 2000)
										}
										          
									</script>
                  <!-- Webhook Düzenle -->
									<div class="modal fade" id="webhookModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
										<div class="modal-dialog modal-dialog-centered">
											<div class="modal-content bg-d">
												<div class="modal-header" style="border: none;">
													<h5 class="modal-title" id="exampleModalLabel">Webhok Ayarları</h5>
													<button type="button" class="btn btn-primary" data-bs-dismiss="modal">
													<i class="fas fa-times text-white hover:text-indigo-500 transition-all duration-100"></i>
													</button>
												</div>
												<div class="modal-body">
													<form id="myEditForm" method="POST" class="form-discorddark">

														<div class="form-group">
															<label style="color: var(--body-text)!important;">
																<h6>Webhook Bağlantısı;</h6>
															</label>
															<input type="text" class="form-control bg-gray-700 text-white border-none" value="<%= db ? (db.webhook ? db.webhook.link : '') : '' %>" placeholder="https://discord.com/api/webhooks/123123123/qwe" id="webhookEdit" name="webhookEdit" />
														</div>

														<div class="form-group">
															<label style="color: var(--body-text)!important;">
																<h6>Webhook Mesajı;</h6>
															</label>
															<textarea type="text" class="form-control bg-gray-700 text-white border-none" value="<%= db ? (db.webhook ? db.webhook.text : '') : '' %>" placeholder="{user} adlı kullanıcı sunucumuza kalp attı. Sunucumuz {heartCount} kalp sayısına ulaştı." id="webhookText" name="webhookText"></textarea>
														</div>
                            <p class="text-muted h6 mt-4">
                              Webhook Mesaj Parametreleri;<br /><br />
                              {user}: Kullanıcıyı etiketler.<br />
                              {user.tag}: Kullanıcının adını etiketiyle beraber yazar.<br />
                              {heartCount}: Sunucunun toplam kalp sayısını yazar.<br />
                              {guild.name}: Sunucunun adını yazar.<br />
                             </p>
												<div class="modal-footer" style="border: none;">
												<button type="button" onclick="clickOnEditWebhook()" id="myButtonWebhook" class="btn btn-primary"><i class="fad fa-save"></i>&nbsp;Kaydet</button>
												</form>
												</div>
											</div>
										</div>
									</div>
									<script>
										function clickOnEditWebhook() {
										    $("#myButtonWebhook").attr("disabled", true);
										    $("#myButtonWebhook").html('<i class="fad fa-spinner fa-w-16 fa-pulse fa-lg"></i>');
										    setTimeout(() => {
										        $.post("/server/<%= guild.id %>/webhook", {
										                message: $('#webhookText').val(),
										                webhook: $('#webhookEdit').val(),
										            })
										            .done(function(data) {
										                if (data.error) {
										                    Swal.fire({
										                        icon: 'error',
										                        title: 'Olamaaz...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myButtonWebhook").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myButtonWebhook").attr("disabled", false);
										                    return;
										                } else {
										                    Swal.fire({
										                        icon: 'success',
										                        title: 'Başarılı...',
										                        closeOnConfirm: false,
										                        text: data.message
										                    })
										                    $("#myButtonWebhook").html('<i class="fad fa-save"></i>&nbsp;Kaydet');
										                    $("#myButtonWebhook").attr("disabled", false);
										                     return;
										                }
										            });
										    }, 2000)
										}
										          
									</script>

									<% } %>
                  <% if (db) { %>
									<a href="<%= db.invite %>" class="btn btn-primary">Sunucuya Katıl</a>&nbsp;
									<% } else { %>
									<span class="tippy" data-tippy-content="Sunucunun davet bağlantısı ayarlanmamış."><a href="#" class="btn btn-primary disabled">Sunucuya Katıl</a></span>&nbsp;
                  <% } %>
                  <% if(user) { %>
                  <% if(user && guild.members.cache.get(user.id) && guild.members.cache.get(user.id).permissions.has('MANAGE_GUILD')) { %>
                  <span class="tippy" data-tippy-content="Yetkili olduğun sunucuyu raporlayamazsın.">
                     <a href="#" class="btn btn-danger disabled">Sunucuyu Raporla</a>
                  </span>
                  <% } else { %>
                  <a href="#" class="btn btn-danger">Sunucuyu Raporla</a>
                  <% } %>
                  <% } else { %>
									<span class="tippy" data-tippy-content="Sunucuyu raporlamak için giriş yapmalısın."><a href="#" class="btn btn-danger disabled">Sunucuyu Raporla</a></span>&nbsp;
                  <% } %>
								</div>
							</div>
						</div>
					</div>
					<br />
				</div>
			</div>
		</div>
	</div>
</div>
<div class="__desion_wave-top __desion_wave"></div>
<div class="container">
        <nav>
          <div class="nav nav-tabs items-center p-2" x-data={show:false}>
                <button class="nav-link desion-tabs active rounded-md mt-2" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#stats" type="button" role="tab" aria-controls="Server" aria-selected="true"><i class="fas fa-book"></i>&nbsp;Genel Bilgiler</button>
                <button class="nav-link desion-tabs rounded-md mt-2" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" aria-controls="Server" aria-selected="true"><i class="fas fa-star-half-alt"></i>&nbsp;Derecelendirmeler</button>
                <button class="nav-link desion-tabs rounded-md mt-2" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#analytics" type="button" role="tab" aria-controls="Server" aria-selected="true"><i class="fas fa-sort-amount-up"></i>&nbsp;Analitikler</button>
          </div>
        </nav>
<div class="tab-content" id="nav-tabContent">
  
  
	<div class="tab-pane show active fade" id="stats" role="tabpanel" aria-labelledby="nav-home-tab">
    <div class="flex flex-wrap pt-4 w-full">
		<div class="w-full sm:w-1/2 md:w-1/4 flex flex-col p-2">
			<div class="bg-d rounded-lg border-t-4 border-indigo-400">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">Sunucu Kategorisi</div>
					<% if(db) { %>
          <% let serverTag = global.config.website.tags.find(element => element.value === db.tag) %>
          <% if(serverTag) { %>
					<div class="text-xl text-left mt-3"><i class="<%= serverTag.icon %>"></i>&nbsp;<%= serverTag.name %></div>
          <% } else { %>
					<div class="text-xl text-left mt-3"><i class="fas fa-times"></i>&nbsp;Ayarlanmamış</div>
          <% } %>
					<% } else { %>
					<div class="text-xl text-left mt-3"><i class="fas fa-times"></i>&nbsp;Ayarlanmamış</div>
					<% } %>
				</div>
			</div>
      
			<div class="bg-d rounded-lg mt-2">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">Sunucu Bilgisi</div>
          <% moment.locale("tr") %>
					<div class="text-sm text-left text-muted mt-3"><i class="fas fa-calendar"></i>&nbsp;Kuruluş: <%= moment(guild.createdAt).format('DD MMMM YYYY') %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-crown"></i>&nbsp;Sunucu Sahibi: <%= client.users.cache.get(guild.ownerID) ? client.users.cache.get(guild.ownerID).tag : 'undefined#0000' %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-users"></i>&nbsp;Üye Sayısı: <%= guild.memberCount.toLocaleString() %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-robot"></i>&nbsp;Bot Sayısı: <%= guild.members.cache.filter(a => a.user.bot).size %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-chevron-circle-up"></i>&nbsp;Takviye Sayısı: <%= guild.premiumSubscriptionCount %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-diamond"></i>&nbsp;Takviye Seviyesi: <%= guild.premiumTier %></div>
          <% if(guild.vanityURLCode) { %>
					  <div class="text-sm text-left text-muted mt-1"><i class="fas fa-link"></i>&nbsp;Özel Bağlantı: <%= guild.vanityURLCode %></div>
          <% } %>
          <% if(guild.preferredLocale) { %>
					  <div class="text-sm text-left text-muted mt-1"><i class="fas fa-language"></i>&nbsp;Birincil Dil: <%= guild.preferredLocale %></div>
          <% } %>
        </div>
			</div>
      
			<div class="bg-d rounded-lg mt-2 border-b-4 border-indigo-400">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">Kanal Bilgisi</div>
					<div class="text-sm text-left text-muted mt-3"><i class="fas fa-volume"></i>&nbsp;Ses: <%= guild.channels.cache.filter(a => a.type === 'voice').size %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-hashtag"></i>&nbsp;Metin: <%= guild.channels.cache.filter(a => a.type === 'text').size %></div>
					<div class="text-sm text-left text-muted mt-1"><i class="fas fa-caret-down"></i>&nbsp;Kategori: <%= guild.channels.cache.filter(a => a.type === 'category').size %></div>
        </div>
			</div>

      
		</div>
		<div class="w-full sm:w-1/2 md:w-1/2 flex flex-col p-2">
			<div class="bg-d rounded-lg border-t-4 border-indigo-400 border-b-4 border-indigo-400">
        <% if(db) { %>
              
                <div class="bg-teal-100 rounded-b text-teal-900 px-4 py-3 pb-2" role="alert">
                  <% if(db.hearts) { %>
                  <div class="flex items-center mb-4">
                    <div class="py-1"><i class="fas fa-heart"></i>&nbsp;En çok kalp atan kullanıcılar</div>
                  </div>
                  <% Object.keys(db.hearts).sort((a,b) => db.hearts[b] - db.hearts[a]).slice(0, 14).forEach(user => { %>
                  <p class="-mt-2">
                  <a href="/p/<%= user %>">
                    <img class="is-rounded mr-1 inline-block align-middle rounded-full" width="28" onError="imgError(this)" src="<%= client.users.cache.get(user) ? client.users.cache.get(user).avatarURL({ dynamic: true }) : '' %>">
                      <span class="h6 tippy text-white font-normal" data-tippy-content="En çok kalp atmış <%= Object.keys(db.hearts).sort((a,b) => db.hearts[b] - db.hearts[a]).indexOf(user) + 1 %>. kullanıcı">
                      <%= client.users.cache.get(user) ? client.users.cache.get(user).tag : 'undefined#000' %>
                        <span class="h6 float-right font-normal align-bottom text-right">
                          <%= db.hearts[user] %> kalp
                        </span>
                      </span>
                  </a>
                  </p>

                  <% }) %>
                  <% } else { %>
                  <div class="flex items-center mb-4">
                    <div class="py-1"><i class="fa fa-info-circle"></i>&nbsp;En çok kalp atan kullanıcı verisini bulamadım.</div>
                  </div>
                  <% } %>
                </div>

        <% } else { %>
        <div class="bg-teal-100 rounded-b text-teal-900 px-4 py-3 shadow-md" role="alert">
          <div class="flex">
            <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
            <p class="font-bold">Kalp atan bir kullanıcı yok :(</p>
          </div>
        </div>
				<% } %>
			</div>
		</div>
		<div class="w-full sm:w-1/2 md:w-1/4 flex flex-col p-2">
			<div class="bg-d rounded-lg border-t-4 border-indigo-400">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">Kalp Sayısı</div>
					<div class="text-sm text-left mt-2 -mb-5">
						<span class="tippy" data-tippy-content="Bu sunucu bu ay <%= db ? (db.monthHearts ? db.monthHearts : 0): 0 %> defa kalplenmiş.">
						<span class="text-xl">
						<i class="fas fa-heart"></i>&nbsp; <%= db ? (db.monthHearts ? db.monthHearts : 0): 0 %>
						</span>
						</span>
						<% 
							if(db) {
							if(db.lastHeart) { 
							%>
						<p class="text-sm text-muted">
							Son Kalp: <%= db.lastHeart %>
						</p>
						<%
							} 
							}
							%>
						<p class="text-sm text-muted -mt-1">
							Toplam Kalp: <%= db ? (db.totalHearts ? db.totalHearts : 0) : 0 %>
						</p>
						<p class="text-sm text-muted"></p>
					</div>
				</div>
			</div>
      <!-- Ses İstatistikler -->
      <div class="bg-d rounded-lg mt-2">
				<div class="text-white text-center bold font-bold p-4">
					<div class="text-lg text-left">Ses İstatistikleri</div>
          <% moment.locale("tr") %>
          <div class="text-sm text-left text-muted mt-3"><i class="fas fa-headphones"></i>&nbsp;Toplam Ses: <%= db ? moment.duration(db.totalVoiceStats || 0).format('H [saat,] m [dakika]') : 'Yok' %>&nbsp;&nbsp;<i class="fas fa-question-circle tippy" data-tippy-content="Kullanıcıların seste geçirdiği süredir."></i></div>
          <div class="text-sm text-left text-muted mt-1"><i class="fas fa-volume"></i>&nbsp;Sesteki Kullanıcı Sayısı: <%= guild.channels.cache.filter(x => x.type === 'voice').reduce((a,b) => a + b.members.size, 0) %></div>
					
        </div>
			</div>
      <!-- Ses İstatistikler Son -->
      <!-- Emojiler -->
      <div class="bg-d rounded-lg border-b-4 border-indigo-400 mt-2">
				<div class="text-white text-center bold font-bold p-4" x-data={show:false}>
					<div class="text-lg text-left">Emojiler (<%= guild.emojis.cache.size %>)</div>
            <% if(guild.emojis.cache.size > 12) { %>
          
              <div class="text-sm text-left text-muted mt-3 ">
                <div class="grid gap-2 grid-cols-6">
                <% guild.emojis.cache.map(a => a).slice(0, 12).map(emoji => { %>
                     <img src="<%= emoji.url %>" class="tippy" data-tippy-content="<%= emoji.name %>" width="28">
                <% }) %>
                <% guild.emojis.cache.map(a => a).slice(12).map(emoji => { %>                  
                     <img x-show="show" src="<%= emoji.url %>" class="tippy" data-tippy-content="<%= emoji.name %>" width="28">
                <% }) %>
               </div>
             </div>
          
           <button @click="show=!show" x-text="show ? 'Daha az göster' : 'Daha fazla göster'"class="btn btn-primary btn-block w-full mt-2" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample"></button>
          <% } else { %>
              <div class="text-sm text-left text-muted mt-3">
                <div class="grid gap-2 grid-cols-6">
                <% guild.emojis.cache.map(emoji => { %>
                     <img src="<%= emoji.url %>" class="tippy" data-tippy-content="<%= emoji.name %>" width="28">
                <% }) %>
              </div>
             </div>
            <% } %>

          
        </div>
			</div>
      <!-- Emojiler Son -->
    </div>
	</div>
</div>
  
  <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="nav-home-tab"> <!-- Reviews -->
<div class="bg-d border-l-4 border-red-500 text-orange-700 m-4 p-4" role="alert">
  <p class="font-bold">Yakında</p>
  <p>Bu kısım yakın zamanda aktif olacaktır.</p>
</div>
  </div> <!-- Reviews -->
  <div class="tab-pane fade" id="analytics" role="tabpanel" aria-labelledby="nav-home-tab"> <!-- Analytics -->
<div class="bg-d border-l-4 border-red-500 text-orange-700 m-4 p-4" role="alert">
  <p class="font-bold">Yakında</p>
  <p>Bu kısım yakın zamanda aktif olacaktır.</p>
</div>
  </div> <!-- Analytics -->
  
  </div> <!-- Tab Content -->
</div>

<!-- Page Container End -->

<br />
<%- include('../static/footer.ejs') %>